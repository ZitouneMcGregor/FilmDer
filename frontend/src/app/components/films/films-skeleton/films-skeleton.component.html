<div class="min-h-screen bg-[var(--background)]">
  <div class="container mx-auto p-6">
    <!-- Header -->
    <header class="flex flex-col sm:flex-row items-center justify-between">
      <h1 class="text-4xl font-bold text-[var(--text)]">Mes Films</h1>
      <button 
        (click)="openAddMovieModal()" 
        class="mt-4 sm:mt-0 px-4 py-2 bg-[var(--primary)] text-[var(--text)] rounded shadow hover:bg-[var(--accent)] transition">
        Ajouter un film
      </button>
    </header>

    <!-- Barre de recherche pour filtrer les films déjà ajoutés -->
    <div class="mt-6">
      <input 
        type="text" 
        [(ngModel)]="userSearchQuery" 
        placeholder="Rechercher dans vos films..."
        class="w-full p-3 border border-gray-300 rounded focus:outline-none"
      />
    </div>


    
    <!-- Grille des films ajoutés -->
    <section class="mt-8 sm:ml-20">
      <div class="w-full flex justify-center sm:justify-start flex-wrap gap-4">
        <app-films-card 
          *ngFor="let movie of filteredMovies" 
          [movie]="movie" 
          [userId]="userId"
          (movieDeleted)="onMovieDeleted($event)"
          (movieUpdated)="onMovieUpdated($event)"
          class="w-64 mb-4">
        </app-films-card>
      </div>
    </section>
  </div>




  <!-- Modal d'ajout de film -->
  <div *ngIf="showAddMovieModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto p-6 relative">
      <!-- Bouton de fermeture -->
      <button 
        (click)="closeAddMovieModal()" 
        class="absolute top-4 right-4 text-gray-600 hover:text-gray-800 text-3xl">
        &times;
      </button>
      <h2 class="text-2xl font-bold text-[var(--text)] mb-4">Ajouter un film</h2>
      <div class="mb-4">
        <input 
          type="text" 
          [(ngModel)]="searchQuery" 
          placeholder="Rechercher un film sur TMDB..." 
          class="w-full p-3 border border-gray-300 rounded focus:outline-none"
        />
      </div>
      <div>
        <button 
          (click)="searchMovies()" 
          class="px-4 py-2 bg-[var(--primary)] text-[var(--text)] rounded hover:bg-[var(--accent)] transition">
          Rechercher
        </button>
      </div>
      <!-- Résultats de la recherche -->
      <div *ngIf="searchResults?.length" class="mt-6">
        <h3 class="text-xl font-semibold text-[var(--text)] mb-4">Résultats</h3>
        <div class="grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3">
          <div 
            *ngFor="let result of searchResults" 
            class="bg-gray-100 rounded-lg shadow overflow-hidden">
            <div class="relative w-full aspect-[2/3]">
              <img 
                [src]="'https://image.tmdb.org/t/p/w300_and_h450_bestv2/' + result.poster_path" 
                alt="{{ result.title }}" 
                class="absolute inset-0 w-full h-full object-cover">
            </div>
            <div class="p-3">
              <h4 class="text-lg font-bold text-[var(--text)]">{{ result.title }}</h4>
              <p class="text-sm text-gray-600">Sorti : {{ result.release_date }}</p>
              <button 
                (click)="addMovieFromSearch(result)" 
                class="mt-3 w-full px-3 py-2 bg-[var(--primary)] text-[var(--text)] rounded hover:bg-[var(--accent)] transition">
                Ajouter
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
